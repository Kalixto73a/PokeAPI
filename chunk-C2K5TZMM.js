import{b as O,c as $,d as z,e as v,f as H}from"./chunk-Y4YROFD7.js";import{b as Q}from"./chunk-MQOW2MR6.js";import{B as E,C as x,D as L,E as j,F as D,G as M,H as _,I as V,J as B,M as N,O as A,b as K,d as S,e as w,f as R,g as b,h as c,i as f,j as g,m as s,n as m,o as I,p as a,r,s as p,t as l,u as F,v as u,w as h,y as k,z as T}from"./chunk-DKTK7E62.js";var y=(()=>{class t{constructor(e){this.http=e}getPokedexRegionByPokedexUrl(e){return this.http.get(`${e}`)}static{this.\u0275fac=function(o){return new(o||t)(b(V))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var J={1:[1],2:[1],3:[1],4:[1],5:[1],6:[0,1,2],7:[0],8:[0,1,2],9:[0],10:[0,1,2]};var q=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=c({type:t,selectors:[["app-loading-spinner"]],standalone:!0,features:[x],decls:4,vars:0,consts:[[1,"flex","flex-col","fixed","inset-0","flex","items-center","justify-center","bg-black","z-50"],[1,"w-16","h-16","border-4","border-yellow-400","border-t-transparent","rounded-full","animate-spin"],[1,"text-white","mt-4"]],template:function(o,i){o&1&&(r(0,"div",0),l(1,"div",1),r(2,"h1",2),k(3,"It may take a few seconds"),p()())},dependencies:[_]})}}return t})();var G=K(Q());var X=t=>({background:t});function Y(t,P){t&1&&l(0,"app-loading-spinner")}function Z(t,P){if(t&1){let e=F();r(0,"div",3),u("click",function(){let i=f(e).$implicit,n=h();return g(n.goToPokemonDetails(i.id))}),r(1,"app-sprite-for-each-pokemon",4),u("load",function(){let i=f(e).$implicit,n=h();return g(n.onSpriteLoaded(i.id))}),p(),r(2,"h1",5),k(3),p(),l(4,"app-pokemon-number",6),r(5,"app-pokemon-types",7),u("typesLoaded",function(i){f(e);let n=h();return g(n.onTypesLoaded(i))}),p()()}if(t&2){let e=P.$implicit;a("ngStyle",L(5,X,e.cardBackground||"#fff")),s(),a("pokemonId",e.id),s(2),T(e.name),s(),a("pokemonId",e.id),s(),a("pokemonId",e.id)}}var _e=(()=>{class t{constructor(e,o,i,n){this.pokedexService=e,this.getRegionDetailsService=o,this.router=i,this.route=n}ngOnInit(){this.initializeValues()}initializeValues(){this.loading=!0,this.pokemons=[],this._regionId=null,this.pokemonTypes=[],this.cardBackground="#fff",this.spritesLoaded=new Set,this.changeRoute()}loadPokemonsForEachRegion(){if(this._regionId===null)return;let e=J[this._regionId];this.getRegionDetailsService.getRegionPokedex(this._regionId,e).pipe(w(o=>{let i=o.map(n=>this.pokedexService.getPokedexRegionByPokedexUrl(n.url));return S(i)})).subscribe({next:o=>{this.pokemons=o.flatMap(i=>i.pokemon_entries.map(n=>{let d=n.pokemon_species.url,C=Number(d.split("/").filter(Boolean).pop());return{name:n.pokemon_species.name,url:d,id:C}}))},error:()=>{this.loading=!1,G.default.fire({icon:"error",title:"Oops...",html:"There was an error loading Pok\xE9mon from this Region.",theme:"dark"}).then(o=>{o.isConfirmed&&window.location.reload()})}})}changeRoute(){this.route.paramMap.subscribe(e=>{let o=Number(e.get("id"));o&&o!==this._regionId&&(this._regionId=o,this.loadPokemonsForEachRegion())})}onTypesLoaded(e){let{pokemonId:o,types:i}=e,n=this.calculateCardBackground(i),d=this.pokemons.find(C=>C.id===o);d&&(d.cardBackground=n)}calculateCardBackground(e){if(!e||e.length===0)return"#fff";let o=e.map(i=>$[i.type.name]??"#777");return o.length===1?o[0]:`linear-gradient(135deg, ${o.join(", ")})`}goToPokemonDetails(e){this._regionId!==null&&this.router.navigate(["pokemon",e],{relativeTo:this.route})}onSpriteLoaded(e){this.spritesLoaded.add(e),this.spritesLoaded.size===this.pokemons.length&&(this.loading=!1)}static{this.\u0275fac=function(o){return new(o||t)(m(y),m(v),m(A),m(N))}}static{this.\u0275cmp=c({type:t,selectors:[["app-pokedex-for-each-region"]],standalone:!0,features:[E([y,v]),x],decls:3,vars:2,consts:[[4,"ngIf"],[1,"flex","flex-wrap","justify-center","pt-6","pb-6","gap-6","px-1"],["class","flex flex-col items-center w-[100px] lg:w-[320px] lg:h-[400px] rounded-xl p-2 pb-4 transform transition-transform duration-200 hover:scale-105 font-bold",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"flex","flex-col","items-center","w-[100px]","lg:w-[320px]","lg:h-[400px]","rounded-xl","p-2","pb-4","transform","transition-transform","duration-200","hover:scale-105","font-bold",3,"click","ngStyle"],[1,"items-center",3,"load","pokemonId"],[1,"uppercase","gap-2","text-[0.8rem]","lg:text-[1.5rem]"],[3,"pokemonId"],[1,"flex","justify-center","items-center",3,"typesLoaded","pokemonId"]],template:function(o,i){o&1&&(I(0,Y,1,0,"app-loading-spinner",0),r(1,"div",1),I(2,Z,6,7,"div",2),p()),o&2&&(a("ngIf",i.loading),s(2),a("ngForOf",i.pokemons))},dependencies:[_,j,D,M,O,B,z,H,q]})}}return t})();export{_e as PokedexForEachRegionComponent};
