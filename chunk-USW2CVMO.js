import{b as ee,c as te,d as ie,e as ne}from"./chunk-LAXJG7SX.js";import{a as P,b as de}from"./chunk-O6KF2NHD.js";import{A as l,C as o,D as s,E as c,F as W,G as h,H as V,J as p,K as q,M as N,N as D,O as z,P as Z,Q as X,R as Y,S as b,T as M,U as J,X as K,Z as Q,a as O,b as T,d as ue,e as j,f as S,g as R,h as G,i as B,j as U,k as f,l as x,m as H,n as g,o as _,p as k,r as v,s as y,t as L,u as $,x as u,y as d,z as C}from"./chunk-FEF2B2A6.js";var ce={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Je=T(O({},ce),{"[class.ng-submitted]":"isSubmitted"});var he=new H("CallSetDisabledState",{providedIn:"root",factory:()=>re}),re="always";var fe=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=k({type:i})}static{this.\u0275inj=x({})}}return i})();var oe=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:he,useValue:e.callSetDisabledState??re}]}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=k({type:i})}static{this.\u0275inj=x({imports:[fe]})}}return i})();var F=(()=>{class i{constructor(e){this.http=e}getPokedexRegionByPokedexUrl(e){return this.http.get(`${e}`)}static{this.\u0275fac=function(t){return new(t||i)(g(M))}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var E=(()=>{class i{constructor(e){this.http=e}getRegionDetails(e){return this.http.get(`${P.apiUrl}/region/${e}`).pipe(S(t=>({id:t.id,name:t.name})))}getRegionPokedex(e,t){return this.http.get(`${P.apiUrl}/region/${e}`).pipe(S(n=>t.map(r=>n.pokedexes[r]).filter(Boolean)))}static{this.\u0275fac=function(t){return new(t||i)(g(M))}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var se={1:[1],2:[1],3:[1],4:[1],5:[1],6:[0,1,2],7:[0],8:[0,1,2],9:[0],10:[0,1,2]};var ae=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=_({type:i,selectors:[["app-loading-spinner"]],standalone:!0,features:[D],decls:4,vars:0,consts:[[1,"flex","flex-col","fixed","inset-0","flex","items-center","justify-center","bg-black","z-50"],[1,"w-16","h-16","border-4","border-yellow-400","border-t-transparent","rounded-full","animate-spin"],[1,"text-white","mt-4"]],template:function(t,n){t&1&&(o(0,"div",0),c(1,"div",1),o(2,"h1",2),p(3,"It may take a few seconds"),s()())},dependencies:[b]})}}return i})();var le=ue(de());var _e=i=>({background:i});function ve(i,w){i&1&&c(0,"app-loading-spinner")}function ye(i,w){i&1&&(o(0,"div",9),p(1," That pokemon is not from this region or does not exist"),s())}function Ce(i,w){if(i&1){let e=W();o(0,"div",10),h("click",function(){let n=v(e).$implicit,r=V();return y(r.goToPokemonDetails(n.id))}),o(1,"app-sprite-for-each-pokemon",11),h("load",function(){let n=v(e).$implicit,r=V();return y(r.onSpriteLoaded(n.id))}),s(),o(2,"h1",12),p(3),s(),c(4,"app-pokemon-number",13),o(5,"app-pokemon-types",14),h("typesLoaded",function(n){v(e);let r=V();return y(r.onTypesLoaded(n))}),s()()}if(i&2){let e=w.$implicit;l("ngStyle",z(6,_e,e.cardBackground||"#fff")),u(),l("pokemonId",e.id)("spriteIndex",0),u(2),q(e.name),u(),l("pokemonId",e.id),u(),l("pokemonId",e.id)}}var Dt=(()=>{class i{constructor(e,t,n,r){this.pokedexService=e,this.getRegionDetailsService=t,this.router=n,this.route=r}ngOnInit(){this.initializeValues()}initializeValues(){this.loading=!0,this.searchSubject=new j,this.initialPokemonCount=300,this.remainingPokemons=[],this.pokemons=[],this._regionId=null,this.pokemonTypes=[],this.cardBackground="#fff",this.spritesLoaded=new Set,this.filteredPokemons=[],this.searchText="",this.initSearch(),this.changeRoute()}loadPokemonsForEachRegion(){if(this._regionId===null)return;let e=se[this._regionId];this.getRegionDetailsService.getRegionPokedex(this._regionId,e).pipe(U(t=>{let n=t.map(r=>this.pokedexService.getPokedexRegionByPokedexUrl(r.url));return R(n)})).subscribe({next:t=>{let n=t.flatMap(r=>r.pokemon_entries.map(a=>{let m=a.pokemon_species.url,I=Number(m.split("/").filter(Boolean).pop());return{name:a.pokemon_species.name,url:m,id:I}})).filter((r,a,m)=>a===m.findIndex(I=>I.id===r.id));this.pokemons=n.slice(0,this.initialPokemonCount),this.filteredPokemons=[...this.pokemons],this.remainingPokemons=n.slice(this.initialPokemonCount)},error:()=>{this.loading=!1,le.default.fire({icon:"error",title:"Oops...",html:"There was an error loading Pok\xE9mon from this Region.",theme:"dark"}).then(t=>{t.isConfirmed&&window.location.reload()})}})}changeRoute(){this.route.paramMap.subscribe(e=>{let t=Number(e.get("id"));t&&t!==this._regionId&&(this._regionId=t,this.loadPokemonsForEachRegion())})}onTypesLoaded(e){let{pokemonId:t,types:n}=e,r=this.pokemons.find(a=>a.id===t);r&&(r.cardBackground=this.calculateCardBackground(n))}calculateCardBackground(e){if(!e||e.length===0)return"#fff";let t=e.map(n=>te[n.type.name]??"#777");return t.length===1?t[0]:`linear-gradient(135deg, ${t.join(", ")})`}goToPokemonDetails(e){this._regionId!==null&&this.router.navigate(["pokemon",e],{relativeTo:this.route})}onSpriteLoaded(e){this.spritesLoaded.add(e),this.spritesLoaded.size>=Math.min(this.initialPokemonCount,this.pokemons.length)&&(this.loading=!1,this.loadRemainingPokemons())}loadRemainingPokemons(){if(!this.remainingPokemons.length)return;let t=this.remainingPokemons.splice(0,50);this.pokemons=[...this.pokemons,...t],this.applyFilter(),this.remainingPokemons.length&&setTimeout(()=>this.loadRemainingPokemons(),100)}initSearch(){this.searchSubject.pipe(G(500),B()).subscribe(e=>{this.searchText=e,this.applyFilter()})}applyFilter(){let e=this.searchText.toLowerCase().trim();if(!e){this.filteredPokemons=[...this.pokemons];return}this.filteredPokemons=this.pokemons.filter(t=>t.name.toLowerCase().includes(e))}onSearchChange(e){let t=e.target;this.searchSubject.next(t.value)}static{this.\u0275fac=function(t){return new(t||i)(d(F),d(E),d(Q),d(K))}}static{this.\u0275cmp=_({type:i,selectors:[["app-pokedex-for-each-region"]],standalone:!0,features:[N([F,E]),D],decls:9,vars:3,consts:[[4,"ngIf"],[1,"flex","flex-col","pt-4","justify-center","items-center"],[1,"flex","px-4","py-3","rounded-md","border-2","border-yellow-500","overflow-hidden","min-w-[400px]"],["type","text","placeholder","Search Pokemon",1,"w-full","outline-none","bg-transparent","text-gray-500","text-sm",3,"input"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 192.904 192.904","width","16px",1,"fill-gray-600"],["d","m190.707 180.101-47.078-47.077c11.702-14.072 18.752-32.142 18.752-51.831C162.381 36.423 125.959 0 81.191 0 36.422 0 0 36.423 0 81.193c0 44.767 36.422 81.187 81.191 81.187 19.688 0 37.759-7.049 51.831-18.751l47.079 47.078a7.474 7.474 0 0 0 5.303 2.197 7.498 7.498 0 0 0 5.303-12.803zM15 81.193C15 44.694 44.693 15 81.191 15c36.497 0 66.189 29.694 66.189 66.193 0 36.496-29.692 66.187-66.189 66.187C44.693 147.38 15 117.689 15 81.193z"],["class","mt-4 px-2 py-4 bg-[#FFFF00] rounded-lg",4,"ngIf"],[1,"flex","flex-wrap","justify-center","pt-6","pb-6","gap-6","px-1"],["class","cursor-pointer flex flex-col items-center w-[100px] lg:w-[320px] lg:h-[400px] rounded-xl p-2 pb-4 transform transition-transform duration-200 hover:scale-105 font-bold",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"mt-4","px-2","py-4","bg-[#FFFF00]","rounded-lg"],[1,"cursor-pointer","flex","flex-col","items-center","w-[100px]","lg:w-[320px]","lg:h-[400px]","rounded-xl","p-2","pb-4","transform","transition-transform","duration-200","hover:scale-105","font-bold",3,"click","ngStyle"],[1,"items-center",3,"load","pokemonId","spriteIndex"],[1,"uppercase","gap-2","text-[0.8rem]","lg:text-[1.5rem]"],[3,"pokemonId"],[1,"flex","justify-center","items-center",3,"typesLoaded","pokemonId"]],template:function(t,n){t&1&&(C(0,ve,1,0,"app-loading-spinner",0),o(1,"div",1)(2,"div",2)(3,"input",3),h("input",function(a){return n.onSearchChange(a)}),s(),L(),o(4,"svg",4),c(5,"path",5),s()(),C(6,ye,2,0,"div",6),s(),$(),o(7,"div",7),C(8,Ce,6,8,"div",8),s()),t&2&&(l("ngIf",n.loading),u(6),l("ngIf",n.filteredPokemons.length===0),u(2),l("ngForOf",n.filteredPokemons))},dependencies:[b,Z,X,Y,ee,J,ie,ne,ae,oe]})}}return i})();export{Dt as PokedexForEachRegionComponent};
