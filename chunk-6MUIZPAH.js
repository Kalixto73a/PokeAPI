import{a as Q,b as X,c as Y,d as Z}from"./chunk-BWXAO5TW.js";import{c as ee,d as te,e as ie,f as oe,h as ne}from"./chunk-45H6ITJW.js";import{a as j,b as pe}from"./chunk-W5U7AZVQ.js";import{E as l,F as d,I as h,J as p,M as a,N as s,O as m,P as E,Q as f,R as C,T as g,U as N,W as A,X as $,Y as O,Z as U,_ as P,d as le,e as L,g as R,ga as H,h as B,ha as W,i as V,j as z,k as D,ka as b,la as y,m as k,ma as G,p as x,pa as J,qa as q,r as v,sa as K,v as _,w,x as T}from"./chunk-CPGWRHBB.js";var S=(()=>{class o{constructor(e){this.http=e}getPokedexRegionByPokedexUrl(e){return this.http.get(`${e}`)}static{this.\u0275fac=function(t){return new(t||o)(x(y))}}static{this.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var I=(()=>{class o{constructor(e){this.http=e}getRegionDetails(e){return this.http.get(`${j.apiUrl}/region/${e}`).pipe(R(t=>({id:t.id,name:t.name})))}getRegionPokedex(e,t){return this.http.get(`${j.apiUrl}/region/${e}`).pipe(R(i=>t.map(n=>i.pokedexes[n]).filter(Boolean)))}static{this.\u0275fac=function(t){return new(t||o)(x(y))}}static{this.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var re=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=v({type:o,selectors:[["app-loading-spinner"]],standalone:!0,features:[P],decls:4,vars:0,consts:[[1,"flex","flex-col","fixed","inset-0","flex","items-center","justify-center","bg-black","z-50"],[1,"w-16","h-16","border-4","border-yellow-400","border-t-transparent","rounded-full","animate-spin"],[1,"text-white","mt-4"]],template:function(t,i){t&1&&(a(0,"div",0),m(1,"div",1),a(2,"h1",2),g(3,"It may take a few seconds"),s()())},dependencies:[b]})}}return o})();var se={1:[1],2:[1],3:[1],4:[1],5:[1],6:[0,1,2,3,4],7:[0],8:[0,1,2],9:[0],10:[0,1,2]};var ae=le(pe());function he(o,c){o&1&&m(0,"app-loading-spinner")}function fe(o,c){o&1&&(T(),a(0,"svg",9),m(1,"path",10),s())}function ge(o,c){if(o&1){let e=E();T(),a(0,"svg",11),f("click",function(){_(e);let i=C();return w(i.clearSearch())}),m(1,"path",12),s()}}function ue(o,c){o&1&&(a(0,"div",13)(1,"div",14),g(2," That Pok\xE9mon is not in the pok\xE9dex from this region or does not exist "),s()())}function ke(o,c){if(o&1){let e=E();a(0,"div",15),f("click",function(){let i=_(e).$implicit,n=C();return w(n.goToPokemonDetails(i.id))}),a(1,"app-sprite-for-each-pokemon",16),f("load",function(){let i=_(e).$implicit,n=C();return w(n.onSpriteLoaded(i.id))}),s(),a(2,"h1",17),g(3),s(),m(4,"app-pokemon-number",18)(5,"app-pokemon-types",18),s()}if(o&2){let e=c.$implicit;l(),p("pokemonId",e.id),l(2),N(e.name),l(),p("pokemonId",e.id),l(),p("pokemonId",e.id)}}var Ue=(()=>{class o{constructor(e,t,i,n){this.pokedexService=e,this.getRegionDetailsService=t,this.router=i,this.route=n,this.router.events.subscribe(r=>{r instanceof J&&window.scrollTo({top:0,behavior:"smooth"})})}ngOnInit(){this.initializeValues()}initializeValues(){this.loading=!0,this.searchSubject=new L,this.initialPokemonCount=300,this.remainingPokemons=[],this.pokemons=[],this._regionId=null,this.pokemonTypes=[],this.cardBackground="#fff",this.spritesLoaded=new Set,this.filteredPokemons=[],this.searchText="",this.initSearch(),this.changeRoute()}loadPokemonsForEachRegion(){if(this._regionId===null)return;let e=se[this._regionId];this.getRegionDetailsService.getRegionPokedex(this._regionId,e).pipe(D(t=>{let i=t.map(n=>this.pokedexService.getPokedexRegionByPokedexUrl(n.url));return B(i)})).subscribe({next:t=>{let i=t.flatMap(n=>n.pokemon_entries.map(r=>{let u=r.pokemon_species.url,F=Number(u.split("/").filter(Boolean).pop());return{name:r.pokemon_species.name,url:u,id:F}})).filter((n,r,u)=>r===u.findIndex(F=>F.id===n.id));this.pokemons=i.slice(0,this.initialPokemonCount),this.filteredPokemons=[...this.pokemons],this.remainingPokemons=i.slice(this.initialPokemonCount)},error:()=>{this.loading=!1,ae.default.fire({icon:"error",title:"Oops...",html:"There was an error loading Pok\xE9mon from this Region.",theme:"dark"}).then(t=>{t.isConfirmed&&window.location.reload()})}})}changeRoute(){this.route.paramMap.subscribe(e=>{let t=e.get("regionName");if(!t)return;let i=ne[t.toLowerCase()];i&&i!==this._regionId&&(this.loading=!0,this.pokemons=[],this.filteredPokemons=[],this.spritesLoaded.clear(),this._regionId=i,this.loadPokemonsForEachRegion())})}onTypesLoaded(e,t){let i=this.pokemons.find(n=>n.id===t);i&&(i.types=e.map((n,r)=>({slot:r+1,type:{name:n,url:""}})),i.cardBackground=this.calculateCardBackground(i.types))}calculateCardBackground(e){if(!e||e.length===0)return"#fff";let t=e.map(i=>ie[i.type.name]??"#777");return t.length===1?t[0]:`linear-gradient(135deg, ${t.join(", ")})`}goToPokemonDetails(e){this._regionId!==null&&this.router.navigate(["pokemon",e],{relativeTo:this.route})}onSpriteLoaded(e){this.spritesLoaded.add(e),this.spritesLoaded.size>=Math.min(this.initialPokemonCount,this.pokemons.length)&&(this.loading=!1,this.loadRemainingPokemons())}loadRemainingPokemons(){if(!this.remainingPokemons.length)return;let t=this.remainingPokemons.splice(0,50);this.pokemons=[...this.pokemons,...t],this.applyFilter(),this.remainingPokemons.length&&setTimeout(()=>this.loadRemainingPokemons(),100)}initSearch(){this.searchSubject.pipe(V(500),z()).subscribe(e=>{this.searchText=e,this.applyFilter()})}applyFilter(){let e=this.searchText.toLowerCase().trim();if(!e){this.filteredPokemons=[...this.pokemons];return}this.filteredPokemons=this.pokemons.filter(t=>t.name.toLowerCase().includes(e))}onSearchChange(e){let t=e.target;this.searchSubject.next(t.value)}clearSearch(){this.searchText="",this.applyFilter()}static{this.\u0275fac=function(t){return new(t||o)(d(S),d(I),d(K),d(q))}}static{this.\u0275cmp=v({type:o,selectors:[["app-pokedex-for-each-region"]],standalone:!0,features:[U([S,I]),P],decls:9,vars:6,consts:[[4,"ngIf"],[1,"flex","flex-col","pt-4","justify-center","items-center"],[1,"flex","px-4","py-3","rounded-md","border-2","border-[#FFCB05]","overflow-hidden","w-[320px]","sm:w-[400px]","relative","z-10","bg-white/40"],["type","text","placeholder","Search Pokemon",1,"w-full","outline-none","text-black","text-sm","bg-transparent","pr-8","placeholder-black","font-bold",3,"ngModelChange","input","ngModel"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 192.904 192.904","width","16px","class","fill-black absolute right-2 top-1/2 -translate-y-1/2",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","16px","class","fill-black absolute right-2 top-1/2 -translate-y-1/2 cursor-pointer",3,"click",4,"ngIf"],["class","absolute inset-0 flex justify-center items-center text-center px-4 z-0",4,"ngIf"],[1,"flex","flex-wrap","justify-center","pt-6","pb-6","gap-6","px-1"],["class","cursor-pointer flex flex-col items-center justify-center w-[320px] h-[400px] rounded-xl p-2 pb-4 transform transition-transform duration-200 hover:scale-105 font-bold bg-white/30 border-2 border-[#FFCB05]",3,"click",4,"ngFor","ngForOf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 192.904 192.904","width","16px",1,"fill-black","absolute","right-2","top-1/2","-translate-y-1/2"],["d","m190.707 180.101-47.078-47.077c11.702-14.072 18.752-32.142 18.752-51.831C162.381 36.423 125.959 0 81.191 0 36.422 0 0 36.423 0 81.193c0 44.767 36.422 81.187 81.191 81.187 19.688 0 37.759-7.049 51.831-18.751l47.079 47.078a7.474 7.474 0 0 0 5.303 2.197 7.498 7.498 0 0 0 5.303-12.803zM15 81.193C15 44.694 44.693 15 81.191 15c36.497 0 66.189 29.694 66.189 66.193 0 36.496-29.692 66.187-66.189 66.187C44.693 147.38 15 117.689 15 81.193z"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","16px",1,"fill-black","absolute","right-2","top-1/2","-translate-y-1/2","cursor-pointer",3,"click"],["d","M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.89 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.89a1 1 0 0 0 1.41-1.41L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4z"],[1,"absolute","inset-0","flex","justify-center","items-center","text-center","px-4","z-0"],[1,"bg-[#FFFF00]","rounded-lg","px-6","py-4","font-bold","shadow-lg"],[1,"cursor-pointer","flex","flex-col","items-center","justify-center","w-[320px]","h-[400px]","rounded-xl","p-2","pb-4","transform","transition-transform","duration-200","hover:scale-105","font-bold","bg-white/30","border-2","border-[#FFCB05]",3,"click"],[1,"items-center",3,"load","pokemonId"],[1,"uppercase","gap-2","text-[1.5rem]"],[3,"pokemonId"]],template:function(t,i){t&1&&(h(0,he,1,0,"app-loading-spinner",0),a(1,"div",1)(2,"div",2)(3,"input",3),O("ngModelChange",function(r){return $(i.searchText,r)||(i.searchText=r),r}),f("input",function(r){return i.onSearchChange(r)}),s(),h(4,fe,2,0,"svg",4)(5,ge,2,0,"svg",5),s(),h(6,ue,3,0,"div",6),s(),a(7,"div",7),h(8,ke,6,4,"div",8),s()),t&2&&(p("ngIf",i.loading),l(3),A("ngModel",i.searchText),l(),p("ngIf",!i.searchText),l(),p("ngIf",i.searchText),l(),p("ngIf",i.filteredPokemons.length===0&&!i.loading),l(2),p("ngForOf",i.filteredPokemons))},dependencies:[b,H,W,ee,G,oe,te,re,Z,Q,X,Y]})}}return o})();export{Ue as PokedexForEachRegionComponent};
